<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>退货退款</title>
		<link rel="stylesheet" href="{:C('STATIC_URL')}/Home/css/cssReset.css" type="text/css">
        <link rel="stylesheet" href="{:C('STATIC_URL')}/Home/css/public.css" type="text/css">
        <link rel="shortcut icon" href="{:C('STATIC_URL')}/Home/images/ee.ico" type="image/x-icon">
        <link rel="stylesheet" href="{:C('STATIC_URL')}/Home/css/orderRefund.css" type="text/css">
        <script src="{:C('STATIC_URL')}/Home/js/header.js"></script>
        <script type="text/javascript" src="{:C('STATIC_URL')}/Home/static/jquery-2.0.3.min.js"></script>      
        <style>
        	.refund_img{width:100px;height:auto;float:left;    position: relative;min-height: 38px;}
			.refund_img img{width:100%;height:100%;float:left}
			.refund_img .btn_addimg{ padding: 4px 10px;height: 28px;line-height: 30px;position: absolute;left: 0; cursor: pointer;color: #888;overflow: hidden;display: inline-block;*display: inline;*zoom: 1}
			.refund_img .btn_addimg input{position: absolute;font-size: 100px;right: 0;top: 0;opacity: 0;filter: alpha(opacity=0);cursor: pointer}
        </style> 
	</head>
	<body>
		<include file="Public:header_top" />
		<div class="orderRefund_top">
			<div>
				<a class="logo2" href="http://{$Think.server.HTTP_HOST}" title="中国工业机器人,数控机床多少钱一台,无人机,3d打印机多少钱,农业无人机"></a>
				<p>您的位置： <a href="{:U('Index/index')}">首页</a> > <a href="{:U('MemberOrder/orderList')}">我的订单</a> > <a>退款退货</a> </p>
			</div>			
		</div>	
		<ul class="refund_step">
			<li>
				<span>1</span>买家申请
			</li>
			<li>
				<span>2</span>卖家处理退款申请
			</li>
			<li>
				<span>3</span>退款成功
			</li>
		</ul>
		<div class="orderRefund_box">
			<!--选择服务类型-->
			<div class="fl refund_style">
				<div>请选择您要申请的服务类型</div>
				<ul>
					<li>退货退款</li>
					<li>仅退款</li>
					<li>换货</li>
					<div>
						<img src="{:C('STATIC_URL')}/Home/images/3.jpg">
						<p>请您确保是在“未收到货”或“与卖家协商同意”的前提下申请，否则e橙优品无法保证您退款成功。</p>
						<button>我知道了，继续</button>
					</div>
				</ul>
			</div>
			<!--仅退款-->			
			<div class="fl refund_style_1 refund_style_box">				
				<div>申请服务：<span>仅退款</span></div>
				<div>温馨提示：您只有一次售后维权的机会哦</div>
				<form id="refundForm1">
				<table>					
					<tr>
						<td>退款原因：</td>
						<td><span class="star">*</span></td>
						<td><input type="radio" name="beacuse" value="1"> 未收到货 <input type="radio" name="beacuse" value="2"> 已收到货</td>
					</tr>
					<tr>
						<td>说明：</td>
						<td></td>
						<td><textarea name="content"></textarea></td>
					</tr>
					<tr>
						<td>上传凭证：</td>
						<td></td>
						<td>
							<div class="refund_img">
                                 <img />
                                 <a class="btn_addimg" href="javascript:;">
                                 	<input type="file" name="thumb" onchange='show(this);'>请选凭证图片
                                 </a>                                             
                            </div> <span>？</span> <a class="help" href="javascript:;">上传帮助</a>
							<div>最多5张，每张不超过5M，支持GIF，JPEG，JOG，PNG，BMP格式</div>
						</td>
					</tr>
					<tr>
						<td></td>
						<td></td>
						<td><button class="refund_sub" onclick="return false;">提交申请</button> <a class="return">取消并返回</a></td>
					</tr>
				</table>
				</form>
			</div>
			<!--退货退款-->
			<div class="fl refund_style_2 refund_style_box">
				<div>申请服务：<span>退货退款</span></div>
				<div>温馨提示：您只有一次售后维权的机会哦</div>
				<form id="refundForm2">
				<table>
					<tr>
						<td>退货退款原因：</td>
						<td><span class="star">*</span></td>
						<td>
							<div>
								<span>请选择退货退款原因</span>
								<ul>
									<li>尺寸大小不符</li>
									<li>假冒品牌</li>
									<li>颜色/款式/图案与描述不符</li>
									<li>做工问题</li>
									<li>材质不符/材质造假</li>
									<li>收到商品少件/破损/污渍等</li>
									<li>尺寸排错/不喜欢/效果不好</li>
									<li>其他</li>
								</ul>
							</div>						
						</td>
					</tr>
					<tr>
						<td>说明：</td>
						<td></td>
						<td><textarea></textarea></td>
					</tr>
					<tr>
						<td>上传凭证：</td>
						<td></td>
						<td>
							<div class="refund_img">
                                 <img />
                                 <a class="btn_addimg" href="javascript:;">
                                 	<input type="file" name="thumb" onchange='show(this);'>请选凭证图片
                                 </a>                                             
                            </div> <span>？</span> <a class="help" href="javascript:;">上传帮助</a>
							<div>最多5张，每张不超过5M，支持GIF，JPEG，JOG，PNG，BMP格式</div>
						</td>
					</tr>
					<tr>
						<td></td>
						<td></td>
						<td><button>提交申请</button> <a class="return">取消并返回</a></td>
					</tr>
				</table>
				</form>
			</div>
			<!--换货-->
			<div class="fl refund_style_3 refund_style_box">
				<div>申请服务：<span>换货</span></div>
				<div>温馨提示：您只有一次售后维权的机会哦</div>
				<form id="refundForm3">
				<table>
					<tr>
						<td>退货换货原因：</td>
						<td><span class="star">*</span></td>
						<td>
							<div>
								<span>请选择换货原因</span>
							    <ul>
									<li>尺寸大小不符</li>
									<li>颜色/款式/图案与描述不符</li>
									<li>做工问题</li>
									<li>材质不符/材质造假</li>
									<li>收到商品少件/破损/污渍等</li>
									<li>其他</li>
								</ul>
							</div>							
						</td>
					</tr>
					<tr>
						<td>说明：</td>
						<td></td>
						<td><textarea></textarea></td>
					</tr>
					<tr>
						<td>上传凭证：</td>
						<td></td>
						<td>
							<div class="refund_img">
                                 <img />
                                 <a class="btn_addimg" href="javascript:;">
                                 	<input type="file" name="thumb" onchange='show(this);'>请选凭证图片
                                 </a>                                             
                            </div> <span>？</span> <a class="help" href="javascript:;">上传帮助</a>
							<div>最多5张，每张不超过5M，支持GIF，JPEG，JOG，PNG，BMP格式</div>
						</td>
					</tr>
					<tr>
						<td></td>
						<td></td>
						<td><button>提交申请</button> <a class="return">取消并返回</a></td>
					</tr>
				</table>
				</form>
			</div>
			<!--等待商家处理-->
			<div class="fl refunding refund_style_box">
				<div>
					<h3>请等待商家处理 <span class="star">还剩1天23时59分</span></h3>
			        <p>您已经成功发起退款申请，请耐心等待商家处理。</p>
				</div>
				<div>
					<p>· 商家统一或者超时未处理，系统将退款给您。</p>
					<p>· 如果商家拒绝，您可以修改退款申请后再次发起，商家会重新处理</p>
				    <button>修改申请</button>
				    <p>您还可以：<a>撤销申请</a></p>
				</div>
				<div>
					<h3>协商历史</h3>
				</div>
			</div>
			<!--退款成功-->
			<div class="fl refund_ok refund_style_box">
				<div>
					<h3>退款成功</h3>
			        <p>退款成功时间：<span>2017-04-12 14:30:55</span></p>
				</div>
			    <div>
			    	<p>退款总金额：<span class="star">¥20.00</span>  <a>查看钱款去向</a></p>
			    	<div>
			    		<p>退回银行卡：¥20.00</p>
			    		<ul>
			    			<li>
			    				卖家退款
			    				<p>2017-04-12 14:30</p>
			    			</li>
			    			<li>
			    				银行受理
			    				<p>2017-04-12 16:30</p>
			    			</li>
			    			<li>
			    				退款成功
			    				<p>2017-04-12</p>
			    			</li>
			    		</ul>
			    	</div>
			    </div>
			    <div>
			    	<h3>协商历史</h3>
			    	<ul>
			    		<li>
			    			<p>卖家 <span>2017-04-12 14:30:55</span></p>
			    			<p>商家主动同意，退款给买家20.00元。</p>
			    		</li>
			    		<li>
			    			<p>卖家 <span>2017-04-12 14:30:55</span></p>
			    			<p>商家同意了本次售后服务申请。</p>
			    		</li>
			    		<li>
			    			<p>买家 <span>2017-04-12 14:30:55</span></p>
			    			<p>发起了申请，货物状态：未发货，原因：其他，金额：20.00元，说明：...。</p>
			    		</li>
			    	</ul>
			    </div>
			</div>
			<!--订单信息-->
			<div class="right">
				<h3>订单信息</h3>
				<div>
					<img src="{$goods_thumb}" alt="" width="100" />
					<p><a class="order_detail">{$goods_name}</a></p>
				</div>
				<table>
					<tr>
						<td>卖家：</td>
						<td>{$shop_name}</td>
					</tr>
					<tr>
						<td>订单编号：</td>
						<td><a class="order_detail">{$order_sn}</a></td>
					</tr>
					<tr>
						<td>单价：</td>
						<td><span class="star">{$goods_price}</span>元*{$number}（数量）</td>
					</tr>
					<tr>
						<td>快递：</td>
						<td><span class="star">0.00</span>元</td>
					</tr>
				</table>
			</div>
			<!--退款详情-->
			<div class="right2">
				<h3>退款详情</h3>
				<div>
					<p><a class="order_detail">{$goods_name}</a></p>
				</div>
				<table>
					<tr>
						<td>卖家：</td>
						<td>{$shop_name}</td>
					</tr>
					<tr>
						<td>联系电话：</td>
						<td>{$member_name}</td>
					</tr>
					<tr>
						<td>订单编号：</td>
						<td class="order_sn">{$order_sn}</td>
					</tr>
					<tr>
						<td>成交时间：</td>
						<td>{$time|date="Y-m-d H:i:s",###}</td>
					</tr>
					<tr>
						<td>单价：</td>
						<td>¥ {$goods_price}*{$number}（数量）</td>
					</tr>
					<tr>
						<td>邮费：</td>
						<td>¥0.00</td>
					</tr>
					<tr>
						<td>商品总价：</td>
						<td>¥{$total_price}</td>
					</tr>
				</table>
				<table>
					<tr>
						<td>退款编号：</td>
						<td>{$order_sn}</td>
					</tr>
					<tr>
						<td>退款金额：</td>
						<td>¥{$total_price}</td>
					</tr>
					<tr>
						<td>原因：</td>
						<td>其他</td>
					</tr>
					<tr>
						<td>要求：</td>
						<td>仅退款</td>
					</tr>
					<tr>
						<td>货物状态：</td>
						<td>未发货</td>
					</tr>
					<tr>
						<td>说明：</td>
						<td>...</td>
					</tr>
				</table>
			</div>
		</div>
		<!--常见问题-->
		<div class="commonProblem">
			<h3>常见问题</h3>
			<ul>
				<li>
					<p>1.卖家不发货，怎么办？</p>
					亲，如果卖家迟迟不发货，您可以根据目前订单的状态选择对应方式。<a>查看更多</a>
				</li>
				<li>
					<p>2.如何申请退款？</p>
					亲，根据您的订单状态的不同，申请的方式也是不一样的。<a>查看更多</a>
				</li>
				<li>
					<p>申请退款后，交易退款成功，钱退到哪里？</p>
					亲，要先查看退款状态哦，只有当订单的退款状态显示【退款成功】时，钱款才会退回原先的支付渠道。<a>查看更多</a>
				</li>
			</ul>
		</div>
	<script>
	    //上传图片预览
		function show(obj){
		   var file = obj.files[0];   
		   var reader = new FileReader();  
		   //将文件以Data URL形式读入页面  
		   reader.readAsDataURL(file);  
		   reader.onload=function(e){ 
		    //显示文件  
		      $(obj).parent('a').siblings('img').attr("src",this.result);
		      $(".btn_addimg").css("opacity","0").css("height","100%")
		   }
		} 
		//提交仅退款数据
		$(".refund_sub").click(function(){
			request1();
		})
	    //提交数据
		function request1(){  	
		    var data = new FormData($("#refundForm1")[0]);  // 要求使用的html对象
		    var url  = "http://www.orangesha.com/index.php/Home/MemberRefund/refundApplication";
		    var url_ = "{:U('MemberOrder/orderRefund')}";
		    /*console.log()*/
	        data.append("type",{$type});
	        data.append("id",{$order_id});
	        data.append("case",{$goods_price});

		    $.ajax({  
		          url : url ,  
		          type: 'POST',  
		          data: data,  
		          async: true,  
		          // 下面三个参数要指定，如果不指定，会报一个JQuery的错误 
		　　　　　       cache: false,  
		          contentType: false,  
		          processData: false,  
		          success: function (res) {  	              
		              console.log(data);
		              if(res.status){
		                $(".refunding").css("display","block")
		                $(".refund_style_1").css("display","none")
		              } 
		              if(res.status==0){
		              	alert(res.msg);
		              }
		          },  
		          error: function (returndata) {  
		              console.log(returndata); 
		              
		          }  
		     });  
		} 
		
		//判断type是否为1
	    function checkRefund(){
	    	if({$type}==1){
	    		$(".refund_style").css("display","none")
	    		$(".refund_style_1").css("display","block")
	    		$(".return").css("display","none")
	    	}
	    }
	    checkRefund()
	    
	    $(".refund_style>ul li").hover(function(){
			$(this).toggleClass("active");
		})
	    //退货推款
		$(".refund_style>ul li:eq(0)").click(function(){
			$(".refund_style").css("display","none")
			$(".refund_style_2").css("display","block")
			$(".refund_step").css("display","block")
		})
		//仅退款
		$(".refund_style>ul li:eq(1)").click(function(){			
			$(".refund_style>ul>div").css("display","block")
		})
		$(".refund_style>ul button").click(function(){
			$(".refund_style").css("display","none")
			$(".refund_style_1").css("display","block")
			$(".refund_step").css("display","block")
		})
		//换货
		$(".refund_style>ul li:eq(2)").click(function(){
			$(".refund_style").css("display","none")
			$(".refund_style_3").css("display","block")
			$(".refund_step").css("display","block")
		})
		//上传帮助
		$(".refund_style_box tr td .help").click(function(){
			var display = $(this).next("div").css('display');
			if(display=="none"){
				$(this).next("div").css("display","block")
			}
			if(display=="block"){
				$(this).next("div").css("display","none")
			}
		})
		//取消并返回
		$(".return").click(function(){
			$(".refund_style").css("display","block");
			$(".refund_style_box").css("display","none");
			$(".refund_step").css("display","none");
			$(".refund_style>ul>div").css("display","none")
			$("form").resetForm();
		})
		//选择退货退款原因
		$("#refundForm2 tr:eq(0) td div").hover(function(){
			$(this).find("ul").toggle()
		})
		$("#refundForm2 tr:eq(0) td div ul li").click(function(){
			var a = $(this).text();
			$(this).addClass("active");
			$(this).siblings().removeClass("active")
			$("#refundForm2 tr:eq(0) td div span").text(a)
			$(this).find("ul").css("display","none")
		})
		//选择换货原因
		$("#refundForm3 tr:eq(0) td div").hover(function(){
			$(this).find("ul").toggle()
		})
		$("#refundForm3 tr:eq(0) td div ul li").click(function(){
			var a = $(this).text();
			$(this).addClass("active");
			$(this).siblings().removeClass("active")
			$("#refundForm3 tr:eq(0) td div span").text(a)
			$(this).find("ul").css("display","none")
		})
	</script>	
	</body>
</html>
