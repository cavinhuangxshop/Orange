<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>团购商品上传申请</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <script type="text/javascript" charset="utf-8" src="/UEedit/ueditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="/UEedit/ueditor.all.min.js"> </script>
    <!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
    <!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
    <script type="text/javascript" charset="utf-8" src="/UEedit/lang/zh-cn/zh-cn.js"></script>
     <script src="{:C('STATIC_URL')}/Home/js/header.js"></script>
<script type="text/javascript" charset="utf-8" src="/UEedit/jquery-1.9.1.min.js"></script>
    <style type="text/css">
        div{
            width:100%;
        }
		a{
		    text-decoration:none;width:100px;height:40px;background:#46A2E6;border-radius:5px;color:#ffffff;padding:8px 15px 8px 15px;margin-top:10px;
		}
    </style>
<!-- www.orangesha.com Baidu tongji analytics -->
<script>
var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "//hm.baidu.com/hm.js?54f6f54d47704101dc27b337de5fd6c3";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();
</script>
</head>
<body>
<center>
<div>
    
	<form id="editform" action="{:U('Groupcenter/update')}" method="post"  enctype="multipart/form-data" > 
	<input type="hidden" name="imagesName" id="id" value="{$goods.id}" />
	<input type="hidden" name="imagesName" id="imgsNames" value="" />
	<ul style="list-style:none;text-align:left;width:330px;height:auto;">
	<li><h2>团购商品上传申请</h2></li>
	<li>团购标题：<input name="theme" type="text" value="{$goods.title}"></li>	
	<li>商品名称：<input name="name" type="text"  value="{$goods.goodsname}"></li>
	<li>商品价格：<input name="price" type="text"  value="{$goods.goodsprice}">(两位小数点)</li>
	<li>商品主图：<input name="pic" type="file" ></li>
	
	<li><div style="width:200px;height:150px;border:1px solid #ccc;overflow:hidden"><img src="{$goods.pic}" style="width:200px;"></div></li>
	
</ul>
    <script id="editor" type="text/plain" style="width:750px;height:400px;">{$goods.descr}</script>
	<center><a href="javascript:void(0);"  onClick="uptext()" >提交</a></center>
		                      
	 </form>	
</div> 
</center>


<script type="text/javascript">         
   
    //实例化编辑器
    //建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
    var ue = UE.getEditor('editor');

/*	
 function uptext(){	
	var html = '';//定义空字串存放图片名称
        $("#groupform").submit(function(){
            getImgName();
        });
        
}	
*/	
	 function getImgName(){
            $("#imgsNames").val('');//清空内容
            html = ue.getContent();//获取html商品描述内容
            var imgSrc = /\/[0-9]{16}[.]{1}[a-z]{3,}/gi;//正则匹配src内容
            var imgName = /[0-9]{16}[.]{1}[a-z]{3,}/gi;//正则过滤出图片地址,
            if(html.match(imgSrc)){
                var imgsStr = '';
                var imgsName = '';
                imgsStr = html.match(imgSrc).toString();//匹配得到title内容字串,
                imgsName = imgsStr.match(imgName).toString();//匹配得到图片名称字符串,
                $("#imgsNames").val(imgsName);//图片名称字串赋值
           }
        } 
	
	
	
	

 function uptext(){

    if (!ue.hasContents()){
    alert('请先填写内容!');
    }else{ 
	getImgName();

	$('#editform').submit();
    
    }                 

  }

</script>
</body>
</html>